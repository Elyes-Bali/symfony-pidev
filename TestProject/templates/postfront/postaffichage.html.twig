{% extends 'classe/front.html.twig' %}

{% block body %}

    <div class="content-area home-area-1 recent-property" style="background-color: #FCFCFC; padding-bottom: 55px;">
        <div class="container">
            <div class="row mt-4">
                <div class="col-12 text-center">
                    <a href="{{ path('app_post_new') }}" class="btn btn-primary">Add post </a>
                </div>
            </div>
            <div class="row justify-content-center text-center mb-5">
                <div class="col-lg-6">
                    <h2 class="section-title text-center mb-3">Submitted Posts</h2>
                </div>
            </div>

            <div class="row">
                {% for post in pagination %}
                    <div class="col-6 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
                        <div class="media-1">
                            <a href="{{ path('app_post_show', {'id': post.id}) }}" class="d-block mb-3">
                                <img src="{{ asset('uploads/' ~ post.image) }}" alt="Post Image" class="img-fluid">
                            </a>
                            <span class="d-flex align-items-center loc mb-2">
                                <span class="icon-room mr-3"></span>
                                <span>{{ post.sujet }}</span>
                            </span>
                            <div class="d-flex align-items-center">
                                <div>
                                    <h3>{{ post.titre }}</h3>
                                    <div class="price ml-auto">
                                        <span>{{ post.date ? post.date|date('Y-m-d') : '' }}</span>
                                    </div>
                                    <a href="#" class="btn btn-danger" onclick="confirmDelete('{{ post.id }}');">
                                        <i class="fa fa-trash"></i> Delete
                                    </a>

                                    <form id="delete-post-form-{{ post.id }}" action="{{ path('app_post_delete', {'id': post.id}) }}" method="post" style="display: none;">
                                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ post.id) }}">
                                    </form>

                                    <script>
                                        function confirmDelete(postId) {
                                            if (confirm('Are you sure you want to delete this post?')) {
                                                document.getElementById('delete-post-form-' + postId).submit();
                                            }
                                        }
                                    </script>

                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <div class="row mt-4">
                <div class="col-12 text-center">
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center">
                            {{ knp_pagination_render(pagination) }}
                        </ul>
                    </nav>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-12 text-center">
                    <a href="{{ path('app_post_statistics') }}" class="btn btn-primary">View Post Statistics</a>
                </div>
            </div>
        </div>
    </div>

{% endblock %}